<!DOCTYPE html>
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>报表</title>
<link rel="stylesheet" href="%E6%8A%A5%E8%A1%A8_files/ns_report.css">
<link rel="stylesheet" href="%E6%8A%A5%E8%A1%A8_files/ns_report_rsas.css">
<link rel="stylesheet" href="%E6%8A%A5%E8%A1%A8_files/WdatePicker.css">
<script src="%E6%8A%A5%E8%A1%A8_files/jquery.js"></script>
<script src="%E6%8A%A5%E8%A1%A8_files/common.js"></script>
<script src="%E6%8A%A5%E8%A1%A8_files/WdatePicker.js"></script><link href="%E6%8A%A5%E8%A1%A8_files/WdatePicker.css" rel="stylesheet" type="text/css">
</head>
<body>
<div id="report" class="wrapper_w800">
  <div class="report_tip"></div>
  <div id="head" class="report_title">
    <h1>绿盟科技"远程安全评估系统"安全评估报告</h1>
    <span class="note">&nbsp;</span> </div>
  <!--head end,catalog start-->
  <div id="catalog" class="fixed_top" style="width: 900px;">
    <div class="report_h1">目录<a class="h1_dot up"></a></div>
  <div class="report_content" style="display:none"><ul id="catalog_tree"><li><a class="dot up"></a><a class="link" href="#title0">1.综述信息</a><ul style="display:"><li><a class="dot"></a><a class="link" href="#title00">1.1任务信息</a></li><li><a class="dot"></a><a class="link" href="#title01">1.2风险分布</a></li><li><a class="dot"></a><a class="link" href="#title02">1.3风险分类统计</a></li></ul></li><li><a class="dot up"></a><a class="link" href="#title1">2.站点列表</a><ul style="display:"><li><a class="dot"></a><a class="link" href="#title10">2.1站点风险等级列表</a></li></ul></li><li><a class="dot up"></a><a class="link" href="#title2">3.漏洞列表</a><ul style="display:"><li><a class="dot"></a><a class="link" href="#title20">3.1漏洞分布</a></li></ul></li><li><a class="dot up"></a><a class="link" href="#title3">4.参考标准</a><ul style="display:"><li><a class="dot"></a><a class="link" href="#title30">4.1单一漏洞风险等级评定标准</a></li><li><a class="dot"></a><a class="link" href="#title31">4.2页面风险级别评定标准</a></li><li><a class="dot"></a><a class="link" href="#title32">4.3站点风险等级评定标准</a></li><li><a class="dot"></a><a class="link" href="#title33">4.4安全建议</a></li></ul></li></ul></div></div>
  <div id="content"><div class="report_h report_h1" id="title0">1.综述信息<a class="h1_dot"></a></div>
<div class="report_content"><div class="report_h report_h2" id="title00">1.1任务信息<a class="h2_dot"></a></div><div>
    <table class="report_table">
      <tbody>
        <tr class="odd">
          <th style="vertical-align:middle" width="120">网络风险</th>
          <td style="padding:6px;"><img src="%E6%8A%A5%E8%A1%A8_files/b_high.gif" title="非常危险" align="absmiddle"><span class="level_danger middle" style="color:#A60000">非常危险（9.3分）</span></td>
        </tr>
      </tbody>
    </table>
    <table width="100%">
      <tbody><tr>
        <td width="50%" valign="top">
        <table class="report_table plumb">
            <tbody><tr class="odd">
                <th width="120">任务名称</th>
                <td>扫描[http://202.195.66.37/openconf.php]</td>
              </tr>
              <tr class="even">
                <th width="120">扫描目标</th>
                <td>http://202.195.66.37/openconf.php</td>
              </tr>
              <tr class="odd">
                <th>任务类型</th>
                <td>WEB应用扫描</td>
              </tr>
              <tr class="even">
                <th width="120">任务状态</th>
                <td>扫描完成</td>
              </tr><tr class="odd">
                  <th>漏洞扫描模板</th>
                  <td>自动匹配扫描</td>
              </tr><tr class="even">
                <th>下达任务用户</th>
                <td>admin</td>
              </tr>
              <tr class="odd">
                <th>任务数据来源</th>
                <td>本地扫描</td>
              </tr>
              <tr class="even">
                <th>任务说明</th>
                <td></td>
              </tr>
            </tbody>
          </table>
          </td>
        <td width="20px"></td>
        <td width="50%" valign="top">
          <table class="report_table plumb">
            <tbody><tr class="odd">
                  <th width="120px">信息统计</th>
                  <td>
                  已爬取文件数：33<br>
                  有漏洞文件数：22<br>
                  已扫描链接数：57<br>
                  已爬取链接数：60<br>
                  </td>
              </tr>
              <tr class="even">
                  <th width="120px">域名统计</th>
                  <td>
                  已扫描域名数：1<br>
                  非常危险域名数：1</td>
              </tr>
              <tr class="odd">
                <th width="120px">时间统计</th>
                <td>
                    开始：2018-03-23 10:40:53<br>
                    结束：2018-03-23 12:00:59<br>
                    历时：1小时20分6秒</td>
              </tr>
              <tr class="even">
                  <th>版本信息</th>
                  <td>
                  系统版本：V6.0R02F03SP05<br>
                  Web插件版本：V6.0R02F00.0801<br>
                  </td>
              </tr>
            </tbody>
          </table>
        </td>
      </tr>
    </tbody></table>
  </div><div class="report_h report_h2" id="title01">1.2风险分布<a class="h2_dot"></a></div>
  <div>
    <div class="report_h report_h3">1.2.1页面风险级别分布</div>
    <div class="center"><img src="%E6%8A%A5%E8%A1%A8_files/6f9eeff31092a149fa06824ec3501124.png"></div>
    <div class="report_h report_h3">1.2.2漏洞高中低风险分布</div>
    <div class="center"><img src="%E6%8A%A5%E8%A1%A8_files/939d61e2e360686f491e57f43f3c316e.png"></div></div><div class="report_h report_h2" id="title02">1.3风险分类统计<a class="h2_dot"></a></div>
  <div><div class="report_h report_h3" id="title03">1.3.1风险类型</div>
    <div><table width="100%">
          <tbody>
          <tr>
              <td align="center">
                  <div class="center"><img src="%E6%8A%A5%E8%A1%A8_files/c88eeac5d3089bc9f9d8f19117dba9e2.png" width="500px"></div>
              </td>
          </tr>
          <tr>
              <td width="400px" valign="middle">
                  <table class="report_table">
                  <thead>
                  <tr class="second_title">
                      <th>威胁分类</th>
                      <th width="50px">高风险</th>
                      <th width="50px">中风险</th>
                      <th width="50px">低风险</th>
                      <th width="50px">总计</th>
                  </tr>
                  </thead>
                  <tbody><tr class="odd">
                      <td>命令执行类型:SQL注入</td>
                      <td>2</td>
                      <td>0</td>
                      <td>0</td>
                      <td>2</td>
                      </tr><tr class="even">
                      <td>认证类型:暴力猜测</td>
                      <td>0</td>
                      <td>1</td>
                      <td>1</td>
                      <td>2</td>
                      </tr><tr class="odd">
                      <td>信息泄露类型:资源位置可预测</td>
                      <td>0</td>
                      <td>0</td>
                      <td>2</td>
                      <td>2</td>
                      </tr><tr class="even">
                      <td>信息泄露类型:信息泄露</td>
                      <td>0</td>
                      <td>0</td>
                      <td>6</td>
                      <td>6</td>
                      </tr><tr class="odd">
                      <td>命令执行类型:系统命令执行</td>
                      <td>0</td>
                      <td>1</td>
                      <td>0</td>
                      <td>1</td>
                      </tr><tr class="even">
                      <td>逻辑攻击类型:过程验证不充分</td>
                      <td>0</td>
                      <td>0</td>
                      <td>1</td>
                      <td>1</td>
                      </tr><tr class="odd">
                      <td>客户端攻击类型:内容欺骗</td>
                      <td>0</td>
                      <td>0</td>
                      <td>1</td>
                      <td>1</td>
                      </tr></tbody>
                  <tfoot>
                      <tr>
                      <td>合计</td>
                      <td>2</td>
                      <td>2</td>
                      <td>11</td>
                      <td>15</td>
                      </tr>
                  </tfoot>
              </table>
              </td>
          </tr>
          </tbody>
        </table></div><div class="report_h report_h3" id="title03">1.3.2高危漏洞最多页面TOP10</div>
    <div><table id="highvuln_top_10_urls" class="report_table">
            <thead>
            <tr class="second_title">
                <th>页面URL</th>
                <th width="95px">高危漏洞个数</th>
            </tr>
            </thead>
            <tbody><tr class="odd">
                <td>http://202.195.66.37/author/submit.php</td>
                <td>2</td>
                </tr><tr class="even">
                <td>http://202.195.66.37/review/email_username.php</td>
                <td>1</td>
                </tr></tbody>
        </table></div></div></div> <div class="report_h report_h1" id="title1">2.站点列表<a class="h1_dot"></a></div>
<div class="report_content">
  <div class="report_h report_h2" id="title10">2.1站点风险等级列表<a class="h2_dot"></a></div>
  <div>
    <table class="report_table">
        <thead>
        <tr class="first_title">
            <th>站点名称</th>
            <th width="100px">已扫描链接数</th>
            <th width="120px">扫描耗时</th>
            <th width="50px">高风险（个）</th>
            <th width="50px">中风险（个）</th>
            <th width="50px">低风险（个）</th>
            <th width="50px">风险值</th>
        </tr>
        </thead><tbody><tr class="odd">
            <td>
            <img src="%E6%8A%A5%E8%A1%A8_files/d_high.gif" title="非常危险" align="absmiddle">
            <a href="file:///Users/syl/Desktop/300_%E6%89%AB%E6%8F%8F[http___202.195.66.37_openco_____2018_03_23_html/http___202.195.66.37_openconf.php.html" target="_blank">http://202.195.66.37/openconf.php</a>
            </td>
            <td>57</td>
            <td>1小时20分3秒</td>
            <td>3</td>
            <td>6</td>
            <td>70</td>
            <td>9.3</td>
            </tr></tbody>
        
    </table><table class="report_table">
        <thead>
        <tr class="first_title">
            <th colspan="2">异常站点列表</th>
        </tr>
        <tr class="second_title">
            <th>站点名称</th>
            <th>异常原因</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table></div>
</div>

<div class="report_h report_h1" id="title2">3.漏洞列表<a class="h1_dot"></a></div>
<div class="report_content"><div class="report_h report_h2" id="title20">3.1漏洞分布<a class="h2_dot"></a></div>
  <div>
    <div style="text-align:right; vertical-align:middle;">漏洞类别：<img src="%E6%8A%A5%E8%A1%A8_files/vuln_high.gif" align="absbottom">高风险[2]&nbsp;&nbsp;<img src="%E6%8A%A5%E8%A1%A8_files/vuln_middle.gif" align="absbottom">中危险[2]&nbsp;&nbsp;<img src="%E6%8A%A5%E8%A1%A8_files/vuln_low.gif" align="absbottom">低风险[11]&nbsp;&nbsp;</div>
    <table id="vuln_distribution" class="report_table">
        <thead>
        <tr class="second_title">
            <th width="50px">序号</th>
            <th>漏洞名称</th>
            <th width="80px">影响页面个数</th>
            <th width="60px">出现次数</th>
        </tr>
        </thead>
        <tbody><tr class="odd vuln_high" style="cursor:pointer;" onclick="no_toggle('3_1_1','table_3_1_1')">
            <td class="vuln_serial">1</td>
            <td>
            <img id="3_1_1" src="%E6%8A%A5%E8%A1%A8_files/blank.gif" class="ico minus"><img src="%E6%8A%A5%E8%A1%A8_files/vuln_high.gif" align="absmiddle">
            <span style="color:#E42B00">检测到目标URL存在SQL注入漏洞</span></td>
            <td class="page_vuln_count">1</td>
            <td class="vuln_count">2</td>
        </tr>
        <tr class="more hide odd" id="table_3_1_1" style="display: table-row;">
        <th></th>
        <td style="padding-left:20px" class="extend" colspan="4">
            <table style="white-space:pre-wrap;" class="report_table" width="100%"><tbody><tr class="odd">
              <th width="100px">受影响站点</th>
              <td><a href="file:///Users/syl/Desktop/300_%E6%89%AB%E6%8F%8F[http___202.195.66.37_openco_____2018_03_23_html/http___202.195.66.37_openconf.php.html" target="_blank">http://202.195.66.37/openconf.php</a>;&nbsp;</td>
            </tr>
            
            
    <tr class="even">
        <th>详细描述</th>
        <td>  本漏洞属于Web应用安全中的常见漏洞，属于OWASP TOP 10 （2007）中的注入类漏洞。

  很多WEB应用中都存在SQL注入漏洞。SQL注入是一种攻击者利用代码缺陷进行攻击的方式，可在任何能够影响数据库查询的应用程序参数中利用。例如url本身的参数、post数据或cookie值。

   正常的SQL注入攻击很大程度上取决于攻击者使用从错误消息所获得信息。但是，即使没有显示错误消息应用程序仍可能受SQL注入的影响。

   总体上讲，SQL注入是对web应用而不是对web服务器或操作系统本身的攻击。正如其名称所示，SQL注入是对查询添加非预期SQL命令从而以数据库管理员或开发人员非预期的方式操控数据库的行为。如果成功的话，就可以获得、修改、注入或删除有漏洞web应用所使用数据库服务器的数据。在某些环境下，可利用SQL注入完全控制系统。</td>
    </tr>
    
    
    <tr class="odd">
        <th>解决办法</th>
        <td>防护建议包括部署分层安全措施（包括在接受用户输入时使用参数化的查询）、确保应用程序仅使用预期的数据、加固数据库服务器防止不恰当的访问数据。

建议使用以下措施防范SQL注入漏洞：

对于开发
========

使用以下建议编写不受SQL注入攻击影响的web应用。 

参数化查询：SQL注入源于攻击者控制查询数据以修改查询逻辑，因此防范SQL注入攻击的最佳方式就是将查询的逻辑与其数据分隔，这可以防止执行从用户输入所注入的命令。这种方式的缺陷是可能对性能产生影响（但影响很小），且必须以这种方式构建站点上的每个查询才能完全有效。只要无意中绕过了一个查询，就足以导致应用受SQL注入的影响。以下代码显示的是可以进行SQL注入的SQL语句示例。 

sSql = "SELECT LocationName FROM Locations "; sSql = sSql + " WHERE LocationID = " + Request["LocationID"]; oCmd.CommandText = sSql;

下面的例子使用了参数化的查询，不受SQL注入攻击的影响。 

sSql = "SELECT * FROM Locations ";
sSql = sSql + " WHERE LocationID = @LocationID"; oCmd.CommandText = sSql; oCmd.Parameters.Add("@LocationID", Request["LocationID"]); 

应用程序没有包含用户输入向服务器发送SQL语句，而是使用-@LocationID-参数替代该输入，这样用户输入就无法成为SQL执行的命令。这种方式可以有效的拒绝攻击者所注入的任何输入，尽管仍会生成错误，但仅为数据类型转换错误，而不是黑客可以利用的错误。 

以下代码示例显示从HTTP查询字符串中获得产品ID并使用到SQL查询中。请注意传送给SqlCommand的包含有SELECT的字符串仅仅是个静态字符串，不是从输入中截取的。此外还请注意使用SqlParameter对象传送输入参数的方式，该对象的名称（@pid）匹配SQL查询中所使用的名称。

C#示例：

string connString = WebConfigurationManager.ConnectionStrings["myConn"].ConnectionString;
using (SqlConnection conn = new SqlConnection(connString)) 
        { 
            conn.Open();
            SqlCommand cmd = new SqlCommand("SELECT Count(*) FROM Products WHERE ProdID=@pid", conn); 
            SqlParameter prm = new SqlParameter("@pid", SqlDbType.VarChar, 50); 
            prm.Value = Request.QueryString["pid"]; 
            cmd.Parameters.Add(prm); 
            int recCount = (int)cmd.ExecuteScalar();
        } 

VB.NET示例： 

Dim connString As String = WebConfigurationManager.ConnectionStrings("myConn").ConnectionString

Using conn As New SqlConnection(connString) conn.Open()
            Dim cmd As SqlCommand = New SqlCommand("SELECT Count(*) FROM Products WHERE ProdID=@pid", conn)
            Dim prm As SqlParameter = New SqlParameter("@pid", SqlDbType.VarChar, 50) 
            prm.Value = Request.QueryString("pid") 
            cmd.Parameters.Add(prm) 
            Dim recCount As Integer = cmd.ExecuteScalar()
        End Using

验证输入：可通过正确验证用户输入的类型和格式防范大多数SQL注入攻击，最佳方式是通过白名单，定义方法为对于相关的字段只接受特定的帐号号码或帐号类型，或对于其他仅接受英文字母表的整数或字母。很多开发人员都试图使用黑名单字符或转义的方式验证输入。总体上讲，这种方式通过在恶意数据前添加转义字符来拒绝已知的恶意数据，如单引号，这样之后的项就可以用作文字值。这种方式没有白名单有效，因为不可能事先知道所有形式的恶意数据。 

对于安全操作
============

使用以下建议帮助防范对web应用的SQL注入攻击。
 
限制应用程序权限：限制用户凭据，仅使用应用运行所必需权限的。任何成功的SQL注入攻击都会运行在用户凭据的环境中，尽管限制权限无法完全防范SQL注入攻击，但可以大大增加其难度。 

强系统管理员口令策略：通常攻击者需要管理员帐号的功能才能使用特定的SQL命令，如果系统管理员口令较弱的话就比较容易暴力猜测，增加成功SQL注入攻击的可能性。另一个选项就是根本不使用系统管理员口令，而是为特定目的创建特定的帐号。

一致的错误消息方案：确保在出现数据库错误时向用户提供尽可能少的信息。不要泄漏整个错误消息，要同时在web和应用服务器上处理错误消息。当web服务器遇到处理错误时，应使用通用的web页面响应，或将用户重新定向到标准的位置。绝不要泄漏调试信息或其他可能对攻击者有用的细节。 

有关如何在IIS中关闭详细错误消息的说明请见：
http://www.microsoft.com/windows2000/en/server/iis/default.asp?url= /windows2000/en/server/iis/htm/core/iierrcst.htm

使用以下句法在Apache服务器上取缔错误消息:

Syntax: ErrorDocument &lt;3-digit-code&gt;
Example: ErrorDocument 500 /webserver_errors/server_error500.txt

WebSphere之类的应用服务器通常默认安装启用了错误消息或调试设置。有关如何取缔这些错误消息的信息，请参考应用服务器文档。 

存储过程：如果不使用的话，请删除master..Xp_cmdshell、xp_startmail、xp_sendmail、
sp_makewebtask之类的SQL存储过程。

SQL注入漏洞根本上还是取决于web应用程序的代码。尽管不是修复，但可以通过向IDS中添加结合了正则表达式的规则作为紧急措施检测SQL注入攻击。尽管这无法修复所有可能的SQL注入漏洞，但便于实施，并且要求攻击者必须要改进其方法才能实现成功的攻击。可如下使用正则表达式。

删除SQL元字符的正则表达式：
/(\%27)|(\')|(\-\-)|(\%23)|(#)/ix

可如下将上述正则表达式添加到Snort规则：
alert tcp $EXTERNAL_NET any -&gt; $HTTP_SERVERS $HTTP_PORTS (msg:"SQL Injection- Paranoid";flow:to_server,established;uricontent:".pl";pcre:"/(\%27)|(\')|(\-\-)|(%23)|(#)/i"; classtype:Web-application-attack; sid:9099; rev:5;)

传统SQL注入攻击的正则表达式：
/\w*((\%27)|(\'))((\%6F)|o|(\%4F))((\%72)|r|(\%52))/ix

删除有UNION关键字的SQL注入攻击的正则表达式：
/((\%27)|(\'))union/ix
(\%27)|(\')

可为其他的SQL查询（如select、insert、update、delete、drop等）编写类似的正则表达式。

在MS SQL服务器上检测SQL注入攻击的正则表达式：
/exec(\s|\+)+(s|x)p\w+/ix

对于质量保证
============
 
解决SQL注入缺陷最终要求基于代码的修复，“对于开发”和“对于安全操作”部分所述的步骤提供了修复这些漏洞所必要的信息。以下步骤概述了如何对应用程序手动测试SQL注入。 

如何对应用程序手动测试SQL注入：

1. 在浏览器中打开希望测试SQL注入漏洞的web应用。 

2. 将鼠标光标悬停在Web站点的链接上并注意底部的状态栏，可以看到链接所指向的URL。找到其中带有参数的URL，如http://www.site.com/articleid.asp?id=42 

注释：如果没有在状态栏中看到任何URL，请点击链接然后查看地址栏，直到找到带有参数的URL。 

3. 找到带有参数的URL后，点击链接进入网页，在地址栏中可以看到状态栏中的URL。 

4. 有两种测试SQL注入脚本的方法，请使用全部两种方式依次测试每个参数值。 

方法1. 在地址栏中点击光标，高亮显示参数值，如高亮显示name=value中的value并用单引号（'）替换，这时应类似于name='。

方法2. 在地址栏中点击光标，在value中间输入单引号（'），这时应类似于name=val'ue。 

5. 点击GO键将请求发送到Web服务器。

6. 分析Web服务器响应中的错误消息，大多数数据库错误消息都类似于以下示例： 

Example error 1:
Microsoft OLE DB Provider for SQL Server error '80040e14' 
Unclosed quotation mark before the character string '51 ORDER BY some_name'. /some_directory/some_file.asp, line 5 

Example error 2: 
ODBC Error Code = S1000 (General error)
[Oracle][ODBC][Ora]ORA-00933: SQL command not properly ended 

Example error 3: 
Error: 1353 SQLSTATE: HY000 (ER_VIEW_WRONG_LIST)
Message: View's SELECT and view's field list have different column counts 

7. 有时错误消息并不明显，隐藏在页面源码中。如果要查看这些消息，必须查看页面的HTML源码并搜索错误。如果要在Internet Explorer中实现这个操作，点击“查看”菜单，然后选择“源码”选项，这可以打开记事本显示页面的HTML源码。在记事本中，打开“编辑”菜单并选择“查找”。这时会出现一个对话框询问“查找内容”。输入Microsoft OLE DB或[ODBC]然后点击“查找下一个”。 

8. 如果6或7步成功，则Web站点存在SQL注入漏洞。
</td>
    </tr>
    
    <tr class="even">
        <th>威胁分值</th>
        <td>10</td>
    </tr>
    <tr class="odd">
        <th>危险插件</th>
        <td>否</td>
    </tr>
    <tr class="even">
        <th>发现日期</th>
        <td>2001-01-01</td>
    </tr>
    
    
    
    
    
    
    <tr class="odd">
        <th>CVSS评分</th>
        <td>7.3(CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L)</td>
    </tr>
    
    
    
            </tbody></table>
        </td>
        </tr><tr class="even vuln_high" style="cursor:pointer;" onclick="no_toggle('3_1_2','table_3_1_2')">
            <td class="vuln_serial">2</td>
            <td>
            <img id="3_1_2" src="%E6%8A%A5%E8%A1%A8_files/blank.gif" class="ico minus"><img src="%E6%8A%A5%E8%A1%A8_files/vuln_high.gif" align="absmiddle">
            <span style="color:#E42B00">检测到目标URL存在COOKIE注入漏洞</span></td>
            <td class="page_vuln_count">1</td>
            <td class="vuln_count">1</td>
        </tr>
        <tr class="more hide even" id="table_3_1_2" style="display: table-row;">
        <th></th>
        <td style="padding-left:20px" class="extend" colspan="4">
            <table style="white-space:pre-wrap;" class="report_table" width="100%"><tbody><tr class="odd">
              <th width="100px">受影响站点</th>
              <td><a href="file:///Users/syl/Desktop/300_%E6%89%AB%E6%8F%8F[http___202.195.66.37_openco_____2018_03_23_html/http___202.195.66.37_openconf.php.html" target="_blank">http://202.195.66.37/openconf.php</a>;&nbsp;</td>
            </tr>
            
            
    <tr class="even">
        <th>详细描述</th>
        <td>本漏洞属于Web应用安全中的常见漏洞，属于OWASP TOP 10 （2007）中的注入类漏洞。

很多WEB应用中都存在SQL注入漏洞。根据注入点的不同，分为来自Cookie，Header，Get,Post的注入类型，Cookie属于sql注入的一种，攻击很大程度上取决于攻击者使用从错误消息所获得信息。但是，即使没有显示错误消息应用程序仍可能受COOKIE注入的影响。

总体上讲，COOKIE注入是对web应用而不是对web服务器或操作系统本身的攻击。正如其名称所示，COOKIE注入是对查询添加非预期SQL命令从而以数据库管理员或开发人员非预期的方式操控数据库的行为。如果成功的话，就可以获得、修改、注入或删除有漏洞web应用所使用数据库服务器的数据。在某些环境下，可利用COOKIE注入完全控制系统。</td>
    </tr>
    
    
    <tr class="odd">
        <th>解决办法</th>
        <td>防护建议包括部署分层安全措施（包括在接受用户输入时使用参数化的查询）、确保应用程序仅使用预期的数据、加固数据库服务器防止不恰当的访问数据。

建议使用以下措施防范COOKIE注入漏洞：

对于开发
========

使用以下建议编写不受COOKIE注入攻击影响的web应用。 

参数化查询：COOKIE注入源于攻击者控制查询数据以修改查询逻辑，因此防范SQL注入攻击的最佳方式就是将查询的逻辑与其数据分隔，这可以防止执行从用户输入所注入的命令。这种方式的缺陷是可能对性能产生影响（但影响很小），且必须以这种方式构建站点上的每个查询才能完全有效。只要无意中绕过了一个查询，就足以导致应用受COOKIE注入的影响。以下代码显示的是可以进行COOKIE注入的COOKIE语句示例:
$name=$_COOKIE['name'];
$sql="select * from tables where name='$name'";
下面的例子使用了参数化的查询，不受SQL注入攻击的影响
$name=$_COOKIE['name'];
$mysqli=new mysqli("localhost", "user", "pass", "database");
$stmt=$mysqli-&gt;prepare("select * from tables where name=?");
$stmt-&gt;bind_param("s", $name);
$stmt-&gt;execute();

</td>
    </tr>
    
    <tr class="even">
        <th>威胁分值</th>
        <td>10</td>
    </tr>
    <tr class="odd">
        <th>危险插件</th>
        <td>否</td>
    </tr>
    <tr class="even">
        <th>发现日期</th>
        <td>2001-01-01</td>
    </tr>
    
    
    
    
    
    
    <tr class="odd">
        <th>CVSS评分</th>
        <td>7.3(CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L)</td>
    </tr>
    
    
    
            </tbody></table>
        </td>
        </tr><tr class="odd vuln_middle" style="cursor:pointer;" onclick="no_toggle('3_1_3','table_3_1_3')">
            <td class="vuln_serial">3</td>
            <td>
            <img id="3_1_3" src="%E6%8A%A5%E8%A1%A8_files/blank.gif" class="ico plus"><img src="%E6%8A%A5%E8%A1%A8_files/vuln_middle.gif" align="absmiddle">
            <span style="color:#AF6100">检测到目标URL存在http host头攻击漏洞</span></td>
            <td class="page_vuln_count">1</td>
            <td class="vuln_count">1</td>
        </tr>
        <tr class="more hide odd" id="table_3_1_3">
        <th></th>
        <td style="padding-left:20px" class="extend" colspan="4">
            <table style="white-space:pre-wrap;" class="report_table" width="100%"><tbody><tr class="odd">
              <th width="100px">受影响站点</th>
              <td><a href="file:///Users/syl/Desktop/300_%E6%89%AB%E6%8F%8F[http___202.195.66.37_openco_____2018_03_23_html/http___202.195.66.37_openconf.php.html" target="_blank">http://202.195.66.37/openconf.php</a>;&nbsp;</td>
            </tr>
            
            
    <tr class="even">
        <th>详细描述</th>
        <td>为了方便的获得网站域名，开发人员一般依赖于HTTP Host header。例如，在php里用_SERVER["HTTP_HOST"]。但是这个header是不可信赖的，如果应用程序没有对host header值进行处理，就有可能造成恶意代码的传入。</td>
    </tr>
    
    
    <tr class="odd">
        <th>解决办法</th>
        <td>web应用程序应该使用SERVER_NAME而不是host header。
在Apache和Nginx里可以通过设置一个虚拟机来记录所有的非法host header。在Nginx里还可以通过指定一个SERVER_NAME名单，Apache也可以通过指定一个SERVER_NAME名单并开启UseCanonicalName选项。</td>
    </tr>
    
    <tr class="even">
        <th>威胁分值</th>
        <td>5</td>
    </tr>
    <tr class="odd">
        <th>危险插件</th>
        <td>否</td>
    </tr>
    <tr class="even">
        <th>发现日期</th>
        <td>2008-06-12</td>
    </tr>
    
    
    
    
    
    
    <tr class="odd">
        <th>CVSS评分</th>
        <td>6.1(CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)</td>
    </tr>
    
    
    
            </tbody></table>
        </td>
        </tr><tr class="even vuln_middle" style="cursor:pointer;" onclick="no_toggle('3_1_4','table_3_1_4')">
            <td class="vuln_serial">4</td>
            <td>
            <img id="3_1_4" src="%E6%8A%A5%E8%A1%A8_files/blank.gif" class="ico plus"><img src="%E6%8A%A5%E8%A1%A8_files/vuln_middle.gif" align="absmiddle">
            <span style="color:#AF6100">猜测出目标web应用表单登录存在弱口令</span></td>
            <td class="page_vuln_count">5</td>
            <td class="vuln_count">5</td>
        </tr>
        <tr class="more hide even" id="table_3_1_4">
        <th></th>
        <td style="padding-left:20px" class="extend" colspan="4">
            <table style="white-space:pre-wrap;" class="report_table" width="100%"><tbody><tr class="odd">
              <th width="100px">受影响站点</th>
              <td><a href="file:///Users/syl/Desktop/300_%E6%89%AB%E6%8F%8F[http___202.195.66.37_openco_____2018_03_23_html/http___202.195.66.37_openconf.php.html" target="_blank">http://202.195.66.37/openconf.php</a>;&nbsp;</td>
            </tr>
            
            
    <tr class="even">
        <th>详细描述</th>
        <td>通过用户名、密码字典多次尝试目标站点基于表单的登录，猜测出可用于登录该站点的用户名，口令。
由于是通过枚举用户名，口令多次尝试登录，未限制登录错误次数的站点易受到此攻击。
本漏洞属于Web应用安全常见漏洞。</td>
    </tr>
    
    
    <tr class="odd">
        <th>解决办法</th>
        <td>1、建议限制用户错误登录的次数，当超过错误登录次数，锁定该账户。
2、增加口令的复杂度：
1）对于用户注册的口令，建议制定注册口令的复杂度要求标准，如：要求口令至少由8个字符组成且口令必须使用大小写字母、数字以及~!@#$%^&amp;*()-+_等特殊字符的组合。对于不符合复杂度要求的口令，不允许该用户进行注册。
2）对于程序安装过程中出现的默认口令，建议用户及时对默认口令进行修改，可参照1）中口令要求进行修改。</td>
    </tr>
    
    <tr class="even">
        <th>威胁分值</th>
        <td>5</td>
    </tr>
    <tr class="odd">
        <th>危险插件</th>
        <td>否</td>
    </tr>
    <tr class="even">
        <th>发现日期</th>
        <td>2001-01-01</td>
    </tr>
    
    
    
    
    
    
    <tr class="odd">
        <th>CVSS评分</th>
        <td>7.3(CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L)</td>
    </tr>
    
    
    
            </tbody></table>
        </td>
        </tr><tr class="odd vuln_low" style="cursor:pointer;" onclick="no_toggle('3_1_5','table_3_1_5')">
            <td class="vuln_serial">5</td>
            <td>
            <img id="3_1_5" src="%E6%8A%A5%E8%A1%A8_files/blank.gif" class="ico plus"><img src="%E6%8A%A5%E8%A1%A8_files/vuln_low.gif" align="absmiddle">
            <span style="color:#737373">检测到目标服务器存在应用程序错误</span></td>
            <td class="page_vuln_count">1</td>
            <td class="vuln_count">3</td>
        </tr>
        <tr class="more hide odd" id="table_3_1_5">
        <th></th>
        <td style="padding-left:20px" class="extend" colspan="4">
            <table style="white-space:pre-wrap;" class="report_table" width="100%"><tbody><tr class="odd">
              <th width="100px">受影响站点</th>
              <td><a href="file:///Users/syl/Desktop/300_%E6%89%AB%E6%8F%8F[http___202.195.66.37_openco_____2018_03_23_html/http___202.195.66.37_openconf.php.html" target="_blank">http://202.195.66.37/openconf.php</a>;&nbsp;</td>
            </tr>
            
            
    <tr class="even">
        <th>详细描述</th>
        <td>如果攻击者通过伪造包含非应用程序预期的参数或参数值的请求，来探测应用程序（如以下示例所示），那么应用程序可能会进入易受攻击的未定义状态。 攻击者可以从应用程序对该请求的响应中获取有用的信息，且可利用该信息，以找出应用程序的弱点。 
例如，如果参数字段应该是单引号括起来的字符串（如在 ASP 脚本或 SQL 查询中），那么注入的单引号将会提前终止字符串流，从而更改脚本的正常流程/语法。 
错误消息中泄露重要信息的另一个原因，是脚本编制引擎、Web 服务器或数据库配置错误。 

以下是一些不同的变体： 
[1] 除去参数 
[2] 除去参数值 
[3] 将参数值设置为空值 
[4] 将参数值设置为数字溢出（+/- 99999999） 
[5] 将参数值设置为危险字符，如 ' " \' \" ) ; 
[6] 将某字符串附加到数字参数值 

</td>
    </tr>
    
    
    <tr class="odd">
        <th>解决办法</th>
        <td>[1] 检查入局请求，以了解所有预期的参数和值是否存在。 当参数缺失时，发出适当的错误消息，或使用缺省值。 
[2] 应用程序应验证其输入是否由有效字符组成（解码后）。 例如，应拒绝包含空字节（编码为 %00）、单引号、引号等的输入值。 
[3] 确保值符合预期范围和类型。 如果应用程序预期特定参数具有特定集合中的值，那么该应用程序应确保其接收的值确实属于该集合。 例如，如果应用程序预期值在 10..99 范围内，那么就该确保该值确实是数字，且在 10..99 范围内。 
[4] 验证数据属于提供给客户端的集合。 
[5] 请勿在生产环境中输出调试错误消息和异常。 </td>
    </tr>
    
    <tr class="even">
        <th>威胁分值</th>
        <td>3</td>
    </tr>
    <tr class="odd">
        <th>危险插件</th>
        <td>否</td>
    </tr>
    <tr class="even">
        <th>发现日期</th>
        <td>2001-01-01</td>
    </tr>
    
    
    
    
    
    
    <tr class="odd">
        <th>CVSS评分</th>
        <td>5.3(CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)</td>
    </tr>
    
    
    
            </tbody></table>
        </td>
        </tr><tr class="even vuln_low" style="cursor:pointer;" onclick="no_toggle('3_1_6','table_3_1_6')">
            <td class="vuln_serial">6</td>
            <td>
            <img id="3_1_6" src="%E6%8A%A5%E8%A1%A8_files/blank.gif" class="ico plus"><img src="%E6%8A%A5%E8%A1%A8_files/vuln_low.gif" align="absmiddle">
            <span style="color:#737373">检测出目标web应用表单存在口令猜测攻击</span></td>
            <td class="page_vuln_count">7</td>
            <td class="vuln_count">7</td>
        </tr>
        <tr class="more hide even" id="table_3_1_6">
        <th></th>
        <td style="padding-left:20px" class="extend" colspan="4">
            <table style="white-space:pre-wrap;" class="report_table" width="100%"><tbody><tr class="odd">
              <th width="100px">受影响站点</th>
              <td><a href="file:///Users/syl/Desktop/300_%E6%89%AB%E6%8F%8F[http___202.195.66.37_openco_____2018_03_23_html/http___202.195.66.37_openconf.php.html" target="_blank">http://202.195.66.37/openconf.php</a>;&nbsp;</td>
            </tr>
            
            
    <tr class="even">
        <th>详细描述</th>
        <td>暴力破解是一种常见的弱口令猜测攻击方式，通过由字母、数字、字符组成的每一种不同组合进行口令猜测直到发现正确的口令。
如果登录页面对密码猜测攻击没有任何防护措施，攻击者可以采用暴力枚举的方式破解用户口令。</td>
    </tr>
    
    
    <tr class="odd">
        <th>解决办法</th>
        <td>1、建议限制用户错误登录的次数，当超过错误登录次数，锁定该账户。</td>
    </tr>
    
    <tr class="even">
        <th>威胁分值</th>
        <td>3</td>
    </tr>
    <tr class="odd">
        <th>危险插件</th>
        <td>否</td>
    </tr>
    <tr class="even">
        <th>发现日期</th>
        <td>2001-01-01</td>
    </tr>
    
    
    
    
    
    
    <tr class="odd">
        <th>CVSS评分</th>
        <td>5.3(CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)</td>
    </tr>
    
    
    
            </tbody></table>
        </td>
        </tr><tr class="odd vuln_low" style="cursor:pointer;" onclick="no_toggle('3_1_7','table_3_1_7')">
            <td class="vuln_serial">7</td>
            <td>
            <img id="3_1_7" src="%E6%8A%A5%E8%A1%A8_files/blank.gif" class="ico plus"><img src="%E6%8A%A5%E8%A1%A8_files/vuln_low.gif" align="absmiddle">
            <span style="color:#737373">检测到会话cookie中缺少HttpOnly属性</span></td>
            <td class="page_vuln_count">1</td>
            <td class="vuln_count">1</td>
        </tr>
        <tr class="more hide odd" id="table_3_1_7">
        <th></th>
        <td style="padding-left:20px" class="extend" colspan="4">
            <table style="white-space:pre-wrap;" class="report_table" width="100%"><tbody><tr class="odd">
              <th width="100px">受影响站点</th>
              <td><a href="file:///Users/syl/Desktop/300_%E6%89%AB%E6%8F%8F[http___202.195.66.37_openco_____2018_03_23_html/http___202.195.66.37_openconf.php.html" target="_blank">http://202.195.66.37/openconf.php</a>;&nbsp;</td>
            </tr>
            
            
    <tr class="even">
        <th>详细描述</th>
        <td>会话cookie中缺少HttpOnly属性会导致攻击者可以通过程序(JS脚本、Applet等)获取到用户的cookie信息，造成用户cookie信息泄露，增加攻击者的跨站脚本攻击威胁。

HttpOnly是微软对cookie做的扩展，该值指定cookie是否可通过客户端脚本访问。Microsoft Internet Explorer 版本 6 Service Pack 1 和更高版本支持cookie属性HttpOnly。

如果在Cookie中没有设置HttpOnly属性为true，可能导致Cookie被窃取。窃取的Cookie可以包含标识站点用户的敏感信息，如ASP.NET会话ID或Forms身份验证票证，攻击者可以重播窃取的Cookie，以便伪装成用户或获取敏感信息，进行跨站脚本攻击等。

如果在Cookie中设置HttpOnly属性为true，兼容浏览器接收到HttpOnly cookie，那么客户端通过程序(JS脚本、Applet等)将无法读取到Cookie信息，这将有助于缓解跨站点脚本威胁。</td>
    </tr>
    
    
    <tr class="odd">
        <th>解决办法</th>
        <td>向所有会话cookie中添加“HttpOnly”属性。

Java示例：
HttpServletResponse response2 = (HttpServletResponse)response;
response2.setHeader( "Set-Cookie", "name=value; HttpOnly"); 

C#示例：
HttpCookie myCookie = new HttpCookie("myCookie");   
myCookie.HttpOnly = true;  
Response.AppendCookie(myCookie);

VB.NET示例：
Dim myCookie As HttpCookie = new HttpCookie("myCookie")  
myCookie.HttpOnly = True  
Response.AppendCookie(myCookie) 
</td>
    </tr>
    
    <tr class="even">
        <th>威胁分值</th>
        <td>3</td>
    </tr>
    <tr class="odd">
        <th>危险插件</th>
        <td>否</td>
    </tr>
    <tr class="even">
        <th>发现日期</th>
        <td>2009-01-15</td>
    </tr>
    
    
    
    
    
    
    <tr class="odd">
        <th>CVSS评分</th>
        <td>0.0(CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N)</td>
    </tr>
    
    
    
            </tbody></table>
        </td>
        </tr><tr class="even vuln_low" style="cursor:pointer;" onclick="no_toggle('3_1_8','table_3_1_8')">
            <td class="vuln_serial">8</td>
            <td>
            <img id="3_1_8" src="%E6%8A%A5%E8%A1%A8_files/blank.gif" class="ico plus"><img src="%E6%8A%A5%E8%A1%A8_files/vuln_low.gif" align="absmiddle">
            <span style="color:#737373">检测到目标URL存在电子邮件地址模式</span></td>
            <td class="page_vuln_count">3</td>
            <td class="vuln_count">3</td>
        </tr>
        <tr class="more hide even" id="table_3_1_8">
        <th></th>
        <td style="padding-left:20px" class="extend" colspan="4">
            <table style="white-space:pre-wrap;" class="report_table" width="100%"><tbody><tr class="odd">
              <th width="100px">受影响站点</th>
              <td><a href="file:///Users/syl/Desktop/300_%E6%89%AB%E6%8F%8F[http___202.195.66.37_openco_____2018_03_23_html/http___202.195.66.37_openconf.php.html" target="_blank">http://202.195.66.37/openconf.php</a>;&nbsp;</td>
            </tr>
            
            
    <tr class="even">
        <th>详细描述</th>
        <td>Spambot 搜寻因特网站点，开始查找电子邮件地址来构建发送自发电子邮件（垃圾邮件）的邮件列表。 
如果检测到含有一或多个电子邮件地址的响应，可供利用以发送垃圾邮件。 
而且，找到的电子邮件地址也可能是专用电子邮件地址，对于一般大众应是不可访问的。</td>
    </tr>
    
    
    <tr class="odd">
        <th>解决办法</th>
        <td>从 Web 站点中除去任何电子邮件地址，使恶意的用户无从利用。</td>
    </tr>
    
    <tr class="even">
        <th>威胁分值</th>
        <td>1</td>
    </tr>
    <tr class="odd">
        <th>危险插件</th>
        <td>否</td>
    </tr>
    <tr class="even">
        <th>发现日期</th>
        <td>2001-01-01</td>
    </tr>
    
    
    
    
    
    
    <tr class="odd">
        <th>CVSS评分</th>
        <td>5.3(CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)</td>
    </tr>
    
    
    
            </tbody></table>
        </td>
        </tr><tr class="odd vuln_low" style="cursor:pointer;" onclick="no_toggle('3_1_9','table_3_1_9')">
            <td class="vuln_serial">9</td>
            <td>
            <img id="3_1_9" src="%E6%8A%A5%E8%A1%A8_files/blank.gif" class="ico plus"><img src="%E6%8A%A5%E8%A1%A8_files/vuln_low.gif" align="absmiddle">
            <span style="color:#737373">检测到目标服务器上存在web应用默认目录</span></td>
            <td class="page_vuln_count">1</td>
            <td class="vuln_count">1</td>
        </tr>
        <tr class="more hide odd" id="table_3_1_9">
        <th></th>
        <td style="padding-left:20px" class="extend" colspan="4">
            <table style="white-space:pre-wrap;" class="report_table" width="100%"><tbody><tr class="odd">
              <th width="100px">受影响站点</th>
              <td><a href="file:///Users/syl/Desktop/300_%E6%89%AB%E6%8F%8F[http___202.195.66.37_openco_____2018_03_23_html/http___202.195.66.37_openconf.php.html" target="_blank">http://202.195.66.37/openconf.php</a>;&nbsp;</td>
            </tr>
            
            
    <tr class="even">
        <th>详细描述</th>
        <td>web应用架构中的目录都采用常见的目录名。如图片目录images,javascript目录js,不同的目录潜在的危险是不同的。攻击者一般利用常见目录中可能包含的敏感文件获取敏感信息。
本漏洞属于Web应用安全常见漏洞。</td>
    </tr>
    
    
    <tr class="odd">
        <th>解决办法</th>
        <td>如果不需要这些目录，可以删除此类目录；
或者严格限制目录的访问权限。</td>
    </tr>
    
    <tr class="even">
        <th>威胁分值</th>
        <td>1</td>
    </tr>
    <tr class="odd">
        <th>危险插件</th>
        <td>否</td>
    </tr>
    <tr class="even">
        <th>发现日期</th>
        <td>2001-01-01</td>
    </tr>
    
    
    
    
    
    
    <tr class="odd">
        <th>CVSS评分</th>
        <td>5.3(CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)</td>
    </tr>
    
    
    
            </tbody></table>
        </td>
        </tr><tr class="even vuln_low" style="cursor:pointer;" onclick="no_toggle('3_1_10','table_3_1_10')">
            <td class="vuln_serial">10</td>
            <td>
            <img id="3_1_10" src="%E6%8A%A5%E8%A1%A8_files/blank.gif" class="ico plus"><img src="%E6%8A%A5%E8%A1%A8_files/vuln_low.gif" align="absmiddle">
            <span style="color:#737373">检测到目标web应用表单密码类型输入启用了自动完成操作</span></td>
            <td class="page_vuln_count">9</td>
            <td class="vuln_count">18</td>
        </tr>
        <tr class="more hide even" id="table_3_1_10">
        <th></th>
        <td style="padding-left:20px" class="extend" colspan="4">
            <table style="white-space:pre-wrap;" class="report_table" width="100%"><tbody><tr class="odd">
              <th width="100px">受影响站点</th>
              <td><a href="file:///Users/syl/Desktop/300_%E6%89%AB%E6%8F%8F[http___202.195.66.37_openco_____2018_03_23_html/http___202.195.66.37_openconf.php.html" target="_blank">http://202.195.66.37/openconf.php</a>;&nbsp;</td>
            </tr>
            
            
    <tr class="even">
        <th>详细描述</th>
        <td>在web应用form表单中，如果input标签没有指定“autocomplete”属性为“off”，则“autocomplete”的属性会自动默认为“on”。当web应用form表单中的密码类型的input标签的“autocomplete”属性为“on”时，用户若提交了一个新的用户名和密码时，浏览器将会询问用户是否保存该用户名和密码信息。如果用户选择保存，则之后在显示该web应用表单时，用户名和密码将会被自动填充到对应的输入框中。用户一但保存密码，攻击者就可以通过本地从浏览器缓存中获取明文密码，导致用户敏感信息泄露。</td>
    </tr>
    
    
    <tr class="odd">
        <th>解决办法</th>
        <td>修改web应用form表单中密码类型input标签的“autocomplete”属性为“off”。

示例：

1）当密码类型的input标签没有“autocomplete”属性名时，如：
   &lt;input type="password" name="password"&gt;
   则增加“autocomplete”属性为“off”即可，修改为：
   &lt;input type="password" name="password" autocomplete="off"&gt;

2) 当密码类型的input标签有“autocomplete”属性名，但其属性值为“on”时，如：
   &lt;input type="password" name="password" autocomplete="on"&gt;
   则修改“autocomplete”属性为“off”即可，修改为：
   &lt;input type="password" name="password" autocomplete="off"&gt;
</td>
    </tr>
    
    <tr class="even">
        <th>威胁分值</th>
        <td>1</td>
    </tr>
    <tr class="odd">
        <th>危险插件</th>
        <td>否</td>
    </tr>
    <tr class="even">
        <th>发现日期</th>
        <td>2001-01-01</td>
    </tr>
    
    
    
    
    
    
    <tr class="odd">
        <th>CVSS评分</th>
        <td>0.0(CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N)</td>
    </tr>
    
    
    
            </tbody></table>
        </td>
        </tr><tr class="odd vuln_low" style="cursor:pointer;" onclick="no_toggle('3_1_11','table_3_1_11')">
            <td class="vuln_serial">11</td>
            <td>
            <img id="3_1_11" src="%E6%8A%A5%E8%A1%A8_files/blank.gif" class="ico plus"><img src="%E6%8A%A5%E8%A1%A8_files/vuln_low.gif" align="absmiddle">
            <span style="color:#737373">点击劫持：X-Frame-Options未配置</span></td>
            <td class="page_vuln_count">1</td>
            <td class="vuln_count">1</td>
        </tr>
        <tr class="more hide odd" id="table_3_1_11">
        <th></th>
        <td style="padding-left:20px" class="extend" colspan="4">
            <table style="white-space:pre-wrap;" class="report_table" width="100%"><tbody><tr class="odd">
              <th width="100px">受影响站点</th>
              <td><a href="file:///Users/syl/Desktop/300_%E6%89%AB%E6%8F%8F[http___202.195.66.37_openco_____2018_03_23_html/http___202.195.66.37_openconf.php.html" target="_blank">http://202.195.66.37/openconf.php</a>;&nbsp;</td>
            </tr>
            
            
    <tr class="even">
        <th>详细描述</th>
        <td>点击劫持（ClickJacking）是一种视觉上的欺骗手段。攻击者使用一个透明的、不可见的iframe，覆盖在一个网页上，然后诱使用户在该网页上进行操作，此时用户将在不知情的情况下点击透明的iframe页面。通过调整iframe页面的位置，可以诱使用户恰好点击在iframe页面的一些功能性按钮上。
HTTP 响应头信息中的X-Frame-Options，可以指示浏览器是否应该加载一个 iframe 中的页面。如果服务器响应头信息中没有X-Frame-Options，则该网站存在ClickJacking攻击风险。网站可以通过设置 X-Frame-Options 阻止站点内的页面被其他页面嵌入从而防止点击劫持。</td>
    </tr>
    
    
    <tr class="odd">
        <th>解决办法</th>
        <td>修改web服务器配置，添加X-Frame-Options响应头。赋值有如下三种：
1、DENY：不能被嵌入到任何iframe或者frame中。
2、SAMEORIGIN:页面只能被本站页面嵌入到iframe或者frame中。
3、ALLOW-FROM uri：只能被嵌入到指定域名的框架中。
例如：
apache可配置http.conf如下：
&lt;IfModule headers_module&gt;
	Header always append X-Frame-Options "DENY"
&lt;/IfModule&gt;</td>
    </tr>
    
    <tr class="even">
        <th>威胁分值</th>
        <td>1</td>
    </tr>
    <tr class="odd">
        <th>危险插件</th>
        <td>否</td>
    </tr>
    <tr class="even">
        <th>发现日期</th>
        <td>2001-01-01</td>
    </tr>
    
    
    
    
    
    
    <tr class="odd">
        <th>CVSS评分</th>
        <td>7.3(CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L)</td>
    </tr>
    
    
    
            </tbody></table>
        </td>
        </tr><tr class="even vuln_low" style="cursor:pointer;" onclick="no_toggle('3_1_12','table_3_1_12')">
            <td class="vuln_serial">12</td>
            <td>
            <img id="3_1_12" src="%E6%8A%A5%E8%A1%A8_files/blank.gif" class="ico plus"><img src="%E6%8A%A5%E8%A1%A8_files/vuln_low.gif" align="absmiddle">
            <span style="color:#737373">检查出可以对表单中的隐藏字段进行操纵</span></td>
            <td class="page_vuln_count">7</td>
            <td class="vuln_count">10</td>
        </tr>
        <tr class="more hide even" id="table_3_1_12">
        <th></th>
        <td style="padding-left:20px" class="extend" colspan="4">
            <table style="white-space:pre-wrap;" class="report_table" width="100%"><tbody><tr class="odd">
              <th width="100px">受影响站点</th>
              <td><a href="file:///Users/syl/Desktop/300_%E6%89%AB%E6%8F%8F[http___202.195.66.37_openco_____2018_03_23_html/http___202.195.66.37_openconf.php.html" target="_blank">http://202.195.66.37/openconf.php</a>;&nbsp;</td>
            </tr>
            
            
    <tr class="even">
        <th>详细描述</th>
        <td>隐藏字段存在于表单中。通过表单发送数据时，除了用户显式填写的数据外，还包含隐藏字段，隐藏字段采用默认值。用户填写的数据和隐藏字段数据一并发送给服务器端。由于服务器端缺乏对隐藏字段数据的检查，如果修改隐藏字段，可能造成服务器端错误的逻辑处理。</td>
    </tr>
    
    
    <tr class="odd">
        <th>解决办法</th>
        <td>加强字段的检查;检查用户输入的数据是否合法或者在预期的范围内。</td>
    </tr>
    
    <tr class="even">
        <th>威胁分值</th>
        <td>1</td>
    </tr>
    <tr class="odd">
        <th>危险插件</th>
        <td>否</td>
    </tr>
    <tr class="even">
        <th>发现日期</th>
        <td>2001-01-01</td>
    </tr>
    
    
    
    
    
    
    <tr class="odd">
        <th>CVSS评分</th>
        <td>5.3(CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L)</td>
    </tr>
    
    
    
            </tbody></table>
        </td>
        </tr><tr class="odd vuln_low" style="cursor:pointer;" onclick="no_toggle('3_1_13','table_3_1_13')">
            <td class="vuln_serial">13</td>
            <td>
            <img id="3_1_13" src="%E6%8A%A5%E8%A1%A8_files/blank.gif" class="ico plus"><img src="%E6%8A%A5%E8%A1%A8_files/vuln_low.gif" align="absmiddle">
            <span style="color:#737373">检测到基于HTTP连接的登录请求</span></td>
            <td class="page_vuln_count">4</td>
            <td class="vuln_count">4</td>
        </tr>
        <tr class="more hide odd" id="table_3_1_13">
        <th></th>
        <td style="padding-left:20px" class="extend" colspan="4">
            <table style="white-space:pre-wrap;" class="report_table" width="100%"><tbody><tr class="odd">
              <th width="100px">受影响站点</th>
              <td><a href="file:///Users/syl/Desktop/300_%E6%89%AB%E6%8F%8F[http___202.195.66.37_openco_____2018_03_23_html/http___202.195.66.37_openconf.php.html" target="_blank">http://202.195.66.37/openconf.php</a>;&nbsp;</td>
            </tr>
            
            
    <tr class="even">
        <th>详细描述</th>
        <td>检测到目标应用程序使用HTTP连接接受客户端的登录请求，如果登录请求数据没有加密处理，有可能被攻击者嗅探到客户端提交的请求数据，请求数据中一般包含用户名和密码，导致信息泄露。
本漏洞属于Web应用安全常见漏洞.</td>
    </tr>
    
    
    <tr class="odd">
        <th>解决办法</th>
        <td>在提交登录请求数据前加密请求数据；建议使用HTTPS连接发送登录请求数据。</td>
    </tr>
    
    <tr class="even">
        <th>威胁分值</th>
        <td>1</td>
    </tr>
    <tr class="odd">
        <th>危险插件</th>
        <td>否</td>
    </tr>
    <tr class="even">
        <th>发现日期</th>
        <td>2001-01-01</td>
    </tr>
    
    
    
    
    
    
    <tr class="odd">
        <th>CVSS评分</th>
        <td>4.3(CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)</td>
    </tr>
    
    
    
            </tbody></table>
        </td>
        </tr><tr class="even vuln_low" style="cursor:pointer;" onclick="no_toggle('3_1_14','table_3_1_14')">
            <td class="vuln_serial">14</td>
            <td>
            <img id="3_1_14" src="%E6%8A%A5%E8%A1%A8_files/blank.gif" class="ico plus"><img src="%E6%8A%A5%E8%A1%A8_files/vuln_low.gif" align="absmiddle">
            <span style="color:#737373">检测到目标服务器启用了OPTIONS方法</span></td>
            <td class="page_vuln_count">1</td>
            <td class="vuln_count">1</td>
        </tr>
        <tr class="more hide even" id="table_3_1_14">
        <th></th>
        <td style="padding-left:20px" class="extend" colspan="4">
            <table style="white-space:pre-wrap;" class="report_table" width="100%"><tbody><tr class="odd">
              <th width="100px">受影响站点</th>
              <td><a href="file:///Users/syl/Desktop/300_%E6%89%AB%E6%8F%8F[http___202.195.66.37_openco_____2018_03_23_html/http___202.195.66.37_openconf.php.html" target="_blank">http://202.195.66.37/openconf.php</a>;&nbsp;</td>
            </tr>
            
            
    <tr class="even">
        <th>详细描述</th>
        <td>    OPTIONS方法是用于请求获得由Request-URI标识的资源在请求/响应的通信过程中可以使用的功能选项。通过这个方法，客户端可以在采取具体资源请求之前，决定对该资源采取何种必要措施，或者了解服务器的性能。OPTIONS方法可能会暴露一些敏感信息，这些信息将帮助攻击者准备更进一步的攻击。</td>
    </tr>
    
    
    <tr class="odd">
        <th>解决办法</th>
        <td>建议禁用web服务器上的options方法。</td>
    </tr>
    
    <tr class="even">
        <th>威胁分值</th>
        <td>1</td>
    </tr>
    <tr class="odd">
        <th>危险插件</th>
        <td>否</td>
    </tr>
    <tr class="even">
        <th>发现日期</th>
        <td>2001-01-01</td>
    </tr>
    
    
    
    
    
    
    <tr class="odd">
        <th>CVSS评分</th>
        <td>5.3(CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)</td>
    </tr>
    
    
    
            </tbody></table>
        </td>
        </tr><tr class="odd vuln_low" style="cursor:pointer;" onclick="no_toggle('3_1_15','table_3_1_15')">
            <td class="vuln_serial">15</td>
            <td>
            <img id="3_1_15" src="%E6%8A%A5%E8%A1%A8_files/blank.gif" class="ico plus"><img src="%E6%8A%A5%E8%A1%A8_files/vuln_low.gif" align="absmiddle">
            <span style="color:#737373">检测到管理后台登录入口</span></td>
            <td class="page_vuln_count">13</td>
            <td class="vuln_count">21</td>
        </tr>
        <tr class="more hide odd" id="table_3_1_15">
        <th></th>
        <td style="padding-left:20px" class="extend" colspan="4">
            <table style="white-space:pre-wrap;" class="report_table" width="100%"><tbody><tr class="odd">
              <th width="100px">受影响站点</th>
              <td><a href="file:///Users/syl/Desktop/300_%E6%89%AB%E6%8F%8F[http___202.195.66.37_openco_____2018_03_23_html/http___202.195.66.37_openconf.php.html" target="_blank">http://202.195.66.37/openconf.php</a>;&nbsp;</td>
            </tr>
            
            
    <tr class="even">
        <th>详细描述</th>
        <td>检查到目标应用的后台登录入口。管理员应用程序一般用于网站的后台管理，具有全部的权限。这些应用程序可能包含一些敏感信息或具有较低的安全保护，攻击者可以通过该文件获取敏感信息或者进入网站后台，进行恶意操作。</td>
    </tr>
    
    
    <tr class="odd">
        <th>解决办法</th>
        <td>加强访问此类文件的认证和使用安全。
如果不需要此类文件，请删除。
修改为不可预测的文件名。
</td>
    </tr>
    
    <tr class="even">
        <th>威胁分值</th>
        <td>1</td>
    </tr>
    <tr class="odd">
        <th>危险插件</th>
        <td>否</td>
    </tr>
    <tr class="even">
        <th>发现日期</th>
        <td>2001-01-01</td>
    </tr>
    
    
    
    
    
    
    <tr class="odd">
        <th>CVSS评分</th>
        <td>5.3(CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)</td>
    </tr>
    
    
    
            </tbody></table>
        </td>
        </tr></tbody>
        <tfoot>
        <tr class="first_title">
            <td colspan="2">合计</td>
            <td id="page_vuln_count_total">56</td>
            <td id="vuln_count_total">79</td>
        </tr>
        </tfoot>
    </table>
  </div></div><div class="report_h report_h1" id="title3">4.参考标准<a class="h1_dot"></a></div>
<div class="report_content"><div class="report_h report_h2" id="title30">4.1单一漏洞风险等级评定标准<a class="h2_dot"></a></div>
    <div>
        <table class="report_table">
            <tbody>
            <tr class="second_title">
                <td width="80px">危险程度</td>
                <td width="150px">危险值区域</td>
                <td>危险程度说明</td>
            </tr>
            <tr class="even">
                <td><img src="%E6%8A%A5%E8%A1%A8_files/vuln_high.gif" align="absmiddle"> 高</td>
                <td>7 &lt;= 漏洞风险值 &lt;= 10</td>
                <td>攻击者可以远程操作系统文件、读写后台数据库、执行任意命令或进行远程拒绝服务攻击。</td>
            </tr>
            <tr class="odd">
                <td><img src="%E6%8A%A5%E8%A1%A8_files/vuln_middle.gif" align="absmiddle"> 中</td>
                <td>4 &lt;= 漏洞风险值 &lt; 7</td>
                <td>攻击者可以利用Web网站攻击其他用户，读取系统文件或后台数据库。</td>
            </tr>
            <tr class="even">
                <td><img src="%E6%8A%A5%E8%A1%A8_files/vuln_low.gif" align="absmiddle"> 低</td>
                <td>0 &lt;= 漏洞风险值 &lt; 4</td>
                <td>攻击者可以获取某些系统、文件的信息或冒用身份。</td>
            </tr>
            </tbody>
        </table>
        <table class="report_table">
            <tbody><tr class="second_title">
                <td width="80x">分值</td>
                <td>评估标准</td>
            </tr>
            <tr class="even">
                <td>1</td>
                <td>可远程获取Web服务器组件的版本信息。</td>
            </tr>
            <tr class="odd">
                <td>2</td>
                <td>目标Web服务器开放了不必要的服务。</td>
            </tr>
            <tr class="even">
                <td>3</td>
                <td>可远程访问到某些不在目录树中的文件或读取服务器动态脚本的源码。</td>
            </tr>
            <tr class="odd">
                <td>4</td>
                <td>可远程因为会话管理的问题导致身份冒用。</td>
            </tr>
            <tr class="even">
                <td>5</td>
                <td>可远程利用受影响的Web服务器攻击其他浏览网站的用户。</td>
            </tr>
            <tr class="odd">
                <td>6</td>
                <td>可远程读取系统文件或后台数据库。</td>
            </tr>
            <tr class="even">
                <td>7</td>
                <td>可远程读写系统文件、操作后台数据库。</td>
            </tr>
            <tr class="odd">
                <td>8</td>
                <td>可远程以普通用户身份执行命令或进行拒绝服务攻击。</td>
            </tr>
            <tr class="even">
                <td>9</td>
                <td>可远程以管理用户身份执行命令（受限、不太容易利用）。</td>
            </tr>
            <tr class="odd">
                <td>10</td>
                <td>可远程以管理用户身份执行命令（不受限、容易利用）。</td>
            </tr>
            </tbody>
        </table>
    </div><div class="report_h report_h2" id="title31">4.2页面风险级别评定标准<a class="h2_dot"></a></div>
    <div>
      <table class="report_table">
        <tbody>
          <tr class="second_title">
            <td width="100px">页面风险级别</td>
            <td>判定标准</td>
          </tr>
          <tr class="even">
            <td><span class="rect page_high"></span> 高风险</td>
            <td>页面包含的漏洞最高级别为高危</td>
          </tr>
          <tr class="odd">
            <td><span class="rect page_middle"></span> 中风险</td>
            <td>页面包含的漏洞最高级别为中危</td>
          </tr>
          <tr class="even">
            <td><span class="rect page_low"></span> 低风险</td>
            <td>页面包含的漏洞最高级别为低危</td>
          </tr>
          <tr class="odd">
            <td><span class="rect page_safe"></span> 无风险</td>
            <td>页面不包含任何漏洞</td>
          </tr>
        </tbody>
      </table>
      <style>
        .rect{
            display:inline-block;
            width:12px;
            height:12px;
            line-height:12px;
        }
        .page_high{
            background-color:#F4494E;
        }
        .page_middle{
            background-color:#FCCC2C;
        }
        .page_low{
            background-color:#A4D770;
        }
        .page_safe{
            background-color:#DDDDDD;
        }
      </style>
    </div><div class="report_h report_h2" id="title32">4.3站点风险等级评定标准<a class="h2_dot"></a></div>
    <div>
      <table class="report_table">
        <tbody>
          <tr class="second_title">
            <td width="80x">站点风险等级</td>
            <td>站点风险值区域</td>
          </tr>
          <tr class="even">
            <td><img src="%E6%8A%A5%E8%A1%A8_files/d_high.gif" title="非常危险" align="absmiddle"> 非常危险</td>
            <td>8 &lt;= 站点风险值 &lt;= 10</td>
          </tr>
          <tr class="odd">
            <td><img src="%E6%8A%A5%E8%A1%A8_files/d_middle.gif" title="比较危险" align="absmiddle"> 比较危险</td>
            <td>5 &lt;= 站点风险值 &lt; 8</td>
          </tr>
          <tr class="even">
            <td><img src="%E6%8A%A5%E8%A1%A8_files/d_low.gif" title="比较安全" align="absmiddle"> 比较安全</td>
            <td>1 &lt;= 站点风险值 &lt; 5</td>
          </tr>
          <tr class="odd">
            <td><img src="%E6%8A%A5%E8%A1%A8_files/d_safe.gif" title="非常安全" align="absmiddle"> 非常安全</td>
            <td>0 &lt;= 站点风险值 &lt; 1</td>
          </tr>
        </tbody>
      </table>
      <p>说明：</p>
      <ol style="list-style:decimal;padding-left:40px;">
      <li>按照远程安全评估系统的站点风险评估模型计算每个站点的站点风险值。根据得到的站点风险值参考“站点风险等级评定标准”标识站点风险等等级。</li>
      <li>将站点风险等级按照风险值的高低进行排序，得到非常危险、比较危险、比较安全、非常安全四种站点风险等级。</li>
      </ol>
    </div><div class="report_h report_h2" id="title33">4.4安全建议<a class="h2_dot"></a></div>
    <div>
        <div>
            <p style="text-indent: 2em;">随着越来越多的网络访问通过Web界面进行操作，Web安全已经成
为互联网安全的一个热点，基于Web的攻击广为流行，SQL注入、跨站脚本等Web应用层漏洞的存在使得网站沦陷、页面篡改、网页挂马等攻击行为困扰着网
站管理者并威胁着网站以及直接用户的安全。基于此，我们可从如下几个方面来消除这些风险，做到防患于未然：</p>
            <ul style="list-style:circle; padding-left:30px;">
              <li>对网站的开发人员进行安全编码方面的培训，在开发过程避免漏洞的引入能起到事半功倍的效果。</li>
              <li>请专业的安全研究人员或安全公司对架构网站的程序和代码做全面的源码审计，修补所有发现的安全漏洞，这种白盒安全测试比较全面、深入，能发现绝大部分的安全问题。</li>
              <li>在网站上线前，使用Web应用漏洞扫描系统进行安全评估，并修补发现的问题；在网站上线后，坚持更新并使用网站安全监测系统，对整站以及关键页面进行周期和实时监测，及时消除发现的隐患。</li>
              <li>采用专业的Web安全防火墙产品，可以在不修改网站本身的情况下对大多数的Web攻击起到有效的阻断作用，绿盟科技提供了功能强大的WAF产品，可以满足用户在这方面的需求。</li>
              <li>建议网络管理员、系统管理员、安全管理员关注安全信息、安全动态及最新的严重漏洞，特别是影响到Web站点所使用的系统和软件的漏洞，应该在事前设计好应对规划，一旦发现系统受漏洞影响及时采取措施。</li>
            </ul>
        </div>
    </div></div></div>
  <div class="report_tip"></div>
</div>
<!--content end-->


<a title="Back to top" class="gotop" onfoucs="this.blur()" style="display: block;" href="#"></a></body></html>